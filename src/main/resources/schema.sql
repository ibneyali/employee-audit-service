-- Create ADDRESS table
CREATE TABLE ADDRESS (
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ADDRESS_LINE_1 VARCHAR(255) NOT NULL,
    ADDRESS_LINE_2 VARCHAR(255),
    ADDRESS_LINE_3 VARCHAR(255),
    COUNTRY VARCHAR(100) NOT NULL,
    POSTAL_CODE VARCHAR(20),
    CREATED_TIMESTAMP TIMESTAMP NOT NULL,
    UPDATED_TIMESTAMP TIMESTAMP NOT NULL,
    UPDATED_BY VARCHAR(100)
);

-- Create DEPARTMENT table
CREATE TABLE DEPARTMENT (
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NAME VARCHAR(255) NOT NULL,
    CREATED_TIMESTAMP TIMESTAMP NOT NULL,
    UPDATED_TIMESTAMP TIMESTAMP NOT NULL,
    UPDATED_BY VARCHAR(100)
);

-- Create TRAINING table
CREATE TABLE TRAINING (
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NAME VARCHAR(255) NOT NULL,
    DESCRIPTION VARCHAR(1000),
    CREATED_TIMESTAMP TIMESTAMP NOT NULL,
    UPDATED_TIMESTAMP TIMESTAMP NOT NULL,
    UPDATED_BY VARCHAR(100)
);

-- Create EMPLOYEE table
CREATE TABLE EMPLOYEE (
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    FIRST_NAME VARCHAR(100) NOT NULL,
    LAST_NAME VARCHAR(100) NOT NULL,
    EMAIL VARCHAR(255) UNIQUE NOT NULL,
    PHONE VARCHAR(20),
    DEPARTMENT_ID BIGINT,
    ADDRESS_ID BIGINT,
    CREATED_TIMESTAMP TIMESTAMP NOT NULL,
    UPDATED_TIMESTAMP TIMESTAMP NOT NULL,
    UPDATED_BY VARCHAR(100),
    VERSION INT DEFAULT 0,
    FOREIGN KEY (DEPARTMENT_ID) REFERENCES DEPARTMENT(ID),
    FOREIGN KEY (ADDRESS_ID) REFERENCES ADDRESS(ID)
);

-- Create EMPLOYEE_TRAINING table
CREATE TABLE EMPLOYEE_TRAINING (
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    EMP_ID BIGINT NOT NULL,
    TRAINING_ID BIGINT NOT NULL,
    DATE_OF_ALLOCATION DATE,
    STATUS VARCHAR(20),
    CREATED_TIMESTAMP TIMESTAMP NOT NULL,
    UPDATED_TIMESTAMP TIMESTAMP NOT NULL,
    UPDATED_BY VARCHAR(100),
    FOREIGN KEY (EMP_ID) REFERENCES EMPLOYEE(ID),
    FOREIGN KEY (TRAINING_ID) REFERENCES TRAINING(ID)
);
-- Create AUDIT_TABLE for auditing purposes
CREATE TABLE AUDIT_TABLE (
    EVENT_ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    EVENT_DOMAIN VARCHAR(100),
    EVENT_ENTITY VARCHAR(100),
    EVENT_ENTITY_ID BIGINT,
    EVENT_NAME VARCHAR(50),
    EVENT_PAYLOAD CLOB,
    EVENT_SUMMARY VARCHAR(255),
    EVENT_ENTITY_VERSION INT,
    EVENT_TIMESTAMP TIMESTAMP,
    ENTRY_TIMESTAMP TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    EVENT_INITIATOR VARCHAR(100)
);


-- Create indexes for better performance
CREATE INDEX IDX_EMPLOYEE_EMAIL ON EMPLOYEE(EMAIL);
CREATE INDEX IDX_EMPLOYEE_DEPARTMENT ON EMPLOYEE(DEPARTMENT_ID);
CREATE INDEX IDX_EMPLOYEE_TRAINING_EMP ON EMPLOYEE_TRAINING(EMP_ID);
CREATE INDEX IDX_EMPLOYEE_TRAINING_TRAINING ON EMPLOYEE_TRAINING(TRAINING_ID);
